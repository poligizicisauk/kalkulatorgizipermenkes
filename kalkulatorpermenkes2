<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Kalkulator Status Gizi Anak - Permenkes No.2 Tahun 2020</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{font-family: Arial;background:#ffffff;margin:0;}
header{background:#ff8c2b;color:white;padding:18px;font-size:22px;font-weight:bold;text-align:center;}
.container{max-width:960px;margin:20px auto;background:white;border-radius:15px;padding:20px;box-shadow:0 0 10px rgba(0,0,0,.1);}
.gender{display:flex;justify-content:center;gap:40px;margin-bottom:20px;}
.gender div{text-align:center;cursor:pointer;padding:10px;border-radius:12px;}
.gender img{width:120px;}
.gender .active{background:#fff3e3;border:2px solid #ff8c2b;}
input{width:100%;padding:10px;border-radius:8px;border:1px solid #ccc;margin-top:5px;}
label{font-weight:bold;margin-top:10px;display:block;}
button{background:#ff8c2b;color:white;padding:12px 20px;border:none;border-radius:10px;cursor:pointer;font-size:16px;margin-top:10px;}
.result-box{background:#f3ffe7;padding:15px;border-radius:12px;border-left:6px solid #8bc34a;margin-top:15px;}
.chart-card{background:#fff8ef;padding:15px;border-radius:12px;margin-top:15px;}
.error{color:red;font-size:14px;}
footer{text-align:center;color:#777;padding:20px;}
</style>
</head>

<body>

<header>Kalkulator Status Gizi Anak<br>Permenkes No.2 Tahun 2020</header>

<div class="container" id="exportArea">

<h3>Data Anak</h3>

<div class="gender">
 <div id="L" onclick="pilihJK('L')">
  <img src="https://i.imgur.com/EC8i6rM.png">
  <div>Laki-laki</div>
 </div>
 <div id="P" onclick="pilihJK('P')">
  <img src="https://i.imgur.com/L668GdK.png">
  <div>Perempuan</div>
 </div>
</div>

<label>Nama Anak</label>
<input id="nama">

<label>Usia Anak (0–60 bulan)</label>
<input id="usia" type="number" min="0" max="60">

<label>Berat Badan Anak (kg)</label>
<input id="bb" type="number" step="0.1">

<label>Tinggi Badan Anak (cm)</label>
<input id="tb" type="number" step="0.1">

<div class="error" id="err"></div>

<button onclick="hitung()">Hitung Status Gizi</button>

<div id="hasil"></div>

<div class="chart-card">
<canvas id="chartBBU"></canvas>
</div>

<div class="chart-card">
<canvas id="chartTBU"></canvas>
</div>

<div class="chart-card">
<canvas id="chartBBTB"></canvas>
</div>

</div>

<button onclick="downloadPDF()">Unduh PDF</button>

<footer>Standar: Permenkes No.2 Tahun 2020 / WHO 2006</footer>

<script>
let gender="";

function pilihJK(j){
 gender=j;
 document.getElementById('L').classList.remove("active");
 document.getElementById('P').classList.remove("active");
 document.getElementById(j).classList.add("active");
}

function zscore(x,L,M,S){
 if(L===0) return Math.log(x/M)/S;
 return (Math.pow(x/M,L)-1)/(L*S);
}

function kategoriBBU(z){
 if(z<-3) return "Berat badan sangat kurang (gizi buruk)";
 if(z<-2) return "Berat badan kurang (underweight)";
 if(z<=2) return "Berat badan normal";
 return "Berat badan lebih";
}
function kategoriTBU(z){
 if(z<-3) return "Sangat pendek (severely stunted)";
 if(z<-2) return "Pendek (stunted)";
 if(z<=3) return "Normal";
 return "Tinggi";
}
function kategoriBBTB(z){
 if(z<-3) return "Gizi buruk (severely wasted)";
 if(z<-2) return "Gizi kurang (wasted)";
 if(z<=1) return "Normal";
 if(z<=2) return "Risiko gizi lebih";
 return "Gizi lebih / obesitas";
}

function saran(a,b,c){
 if(a<-2 || b<-2 || c<-2)
  return "Perbaiki asupan energi-protein dengan lauk hewani (telur, ayam, ikan), kacang-kacangan, dan minyak sehat. Rutin dipantau di fasilitas kesehatan.";
 if(a>2 || c>2)
  return "Batasi gula, garam, lemak serta makanan olahan. Perbanyak sayur, buah, protein tanpa lemak, dan aktivitas fisik sesuai usia.";
 return "Pertahankan pola makan gizi seimbang dan rutin pantau pertumbuhan anak.";
}

/* =======================================================
   ============== DATA LMS WHO 2006 ======================
   ======================================================= */

/* ---------- BB/U LAKI-LAKI (0–60 bln) ---------- */
const LMS_BBU_L = {
0:{L:0.3487,M:3.3464,S:0.14602},
1:{L:0.2297,M:4.4709,S:0.13395},
2:{L:0.197,M:5.5675,S:0.12385},
3:{L:0.1738,M:6.3762,S:0.11727},
4:{L:0.1553,M:7.0023,S:0.11316},
5:{L:0.1395,M:7.5105,S:0.1108},
6:{L:0.1257,M:7.934,S:0.10958},
7:{L:0.1134,M:8.297,S:0.10902},
8:{L:0.1021,M:8.6151,S:0.10882},
9:{L:0.0917,M:8.9014,S:0.10881},
10:{L:0.082,M:9.1649,S:0.10891},
11:{L:0.073,M:9.4122,S:0.10906},
12:{L:0.0644,M:9.6479,S:0.10925},
13:{L:0.0563,M:9.8749,S:0.10949},
14:{L:0.0487,M:10.0953,S:0.10976},
15:{L:0.0413,M:10.3108,S:0.11007},
16:{L:0.0343,M:10.5228,S:0.11041},
17:{L:0.0275,M:10.7319,S:0.11079},
18:{L:0.0211,M:10.9385,S:0.11119},
19:{L:0.0148,M:11.143,S:0.11163},
20:{L:0.0087,M:11.3462,S:0.1121},
21:{L:0.0029,M:11.5486,S:0.1126},
22:{L:-0.0027,M:11.7504,S:0.11313},
23:{L:-0.0081,M:11.9514,S:0.11369},
24:{L:-0.0133,M:12.1515,S:0.11426},
25:{L:-0.0183,M:12.3506,S:0.11486},
26:{L:-0.023,M:12.5485,S:0.11547},
27:{L:-0.0276,M:12.7453,S:0.1161},
28:{L:-0.032,M:12.9409,S:0.11675},
29:{L:-0.0362,M:13.1353,S:0.11741},
30:{L:-0.0402,M:13.3284,S:0.11809},
31:{L:-0.0441,M:13.5203,S:0.11878},
32:{L:-0.0477,M:13.7109,S:0.11948},
33:{L:-0.0512,M:13.9004,S:0.12019},
34:{L:-0.0546,M:14.0887,S:0.12091},
35:{L:-0.0578,M:14.2759,S:0.12164},
36:{L:-0.0608,M:14.462,S:0.12238},
37:{L:-0.0637,M:14.6471,S:0.12312},
38:{L:-0.0665,M:14.8312,S:0.12387},
39:{L:-0.0691,M:15.0144,S:0.12463},
40:{L:-0.0716,M:15.1967,S:0.12539},
41:{L:-0.074,M:15.3781,S:0.12615},
42:{L:-0.0763,M:15.5586,S:0.12692},
43:{L:-0.0785,M:15.7381,S:0.12769},
44:{L:-0.0806,M:15.9166,S:0.12846},
45:{L:-0.0826,M:16.0942,S:0.12923},
46:{L:-0.0845,M:16.2708,S:0.13},
47:{L:-0.0863,M:16.4463,S:0.13077},
48:{L:-0.088,M:16.6207,S:0.13154},
49:{L:-0.0897,M:16.7941,S:0.13231},
50:{L:-0.0912,M:16.9663,S:0.13308},
51:{L:-0.0927,M:17.1375,S:0.13384},
52:{L:-0.0941,M:17.3075,S:0.1346},
53:{L:-0.0955,M:17.4764,S:0.13536},
54:{L:-0.0967,M:17.6442,S:0.13611},
55:{L:-0.0979,M:17.8108,S:0.13686},
56:{L:-0.099,M:17.9763,S:0.1376},
57:{L:-0.1001,M:18.1406,S:0.13834},
58:{L:-0.1011,M:18.3038,S:0.13907},
59:{L:-0.102,M:18.4658,S:0.13979},
60:{L:-0.1029,M:18.6267,S:0.14051}
};

/* ---------- BB/U PEREMPUAN (0–60 bln) ---------- */
const LMS_BBU_P = {
0:{L:0.3809,M:3.2322,S:0.14171},
1:{L:0.1714,M:4.1873,S:0.13724},
2:{L:0.0962,M:5.1282,S:0.13422},
3:{L:0.0402,M:5.8458,S:0.13206},
4:{L:-0.005,M:6.4237,S:0.13037},
5:{L:-0.043,M:6.8985,S:0.12893},
6:{L:-0.0756,M:7.297,S:0.12767},
7:{L:-0.1039,M:7.6422,S:0.1266},
8:{L:-0.1288,M:7.9487,S:0.12569},
9:{L:-0.1507,M:8.2254,S:0.1249},
10:{L:-0.17,M:8.48,S:0.12422},
11:{L:-0.1872,M:8.7192,S:0.12363},
12:{L:-0.2024,M:8.9481,S:0.12311},
13:{L:-0.2158,M:9.1699,S:0.12264},
14:{L:-0.2278,M:9.387,S:0.12223},
15:{L:-0.2384,M:9.6008,S:0.12186},
16:{L:-0.2478,M:9.8124,S:0.12153},
17:{L:-0.2562,M:10.0226,S:0.12123},
18:{L:-0.2637,M:10.2315,S:0.12096},
19:{L:-0.2703,M:10.4393,S:0.12072},
20:{L:-0.2762,M:10.6464,S:0.1205},
21:{L:-0.2815,M:10.8529,S:0.1203},
22:{L:-0.2862,M:11.059,S:0.12012},
23:{L:-0.2903,M:11.2648,S:0.11995},
24:{L:-0.2939,M:11.4704,S:0.1198},
25:{L:-0.2971,M:11.6758,S:0.11966},
26:{L:-0.2998,M:11.8811,S:0.11953},
27:{L:-0.3022,M:12.0864,S:0.1194},
28:{L:-0.3042,M:12.2916,S:0.11929},
29:{L:-0.3059,M:12.4967,S:0.11918},
30:{L:-0.3074,M:12.7018,S:0.11908},
31:{L:-0.3086,M:12.9068,S:0.11898},
32:{L:-0.3096,M:13.1117,S:0.11889},
33:{L:-0.3103,M:13.3165,S:0.11879},
34:{L:-0.3109,M:13.5212,S:0.1187},
35:{L:-0.3113,M:13.7258,S:0.11862},
36:{L:-0.3116,M:13.9302,S:0.11853},
37:{L:-0.3117,M:14.1345,S:0.11845},
38:{L:-0.3117,M:14.3386,S:0.11837},
39:{L:-0.3115,M:14.5426,S:0.11829},
40:{L:-0.3113,M:14.7464,S:0.11821},
41:{L:-0.3109,M:14.9501,S:0.11813},
42:{L:-0.3105,M:15.1536,S:0.11805},
43:{L:-0.3099,M:15.357,S:0.11797},
44:{L:-0.3093,M:15.5602,S:0.1179},
45:{L:-0.3086,M:15.7632,S:0.11783},
46:{L:-0.3078,M:15.9662,S:0.11776},
47:{L:-0.3069,M:16.169,S:0.11769},
48:{L:-0.306,M:16.3716,S:0.11762},
49:{L:-0.305,M:16.5741,S:0.11755},
50:{L:-0.3039,M:16.7765,S:0.11748},
51:{L:-0.3027,M:16.9787,S:0.11742},
52:{L:-0.3015,M:17.1808,S:0.11735},
53:{L:-0.3003,M:17.3828,S:0.11729},
54:{L:-0.299,M:17.5846,S:0.11723},
55:{L:-0.2976,M:17.7863,S:0.11717},
56:{L:-0.2962,M:17.9879,S:0.11711},
57:{L:-0.2948,M:18.1893,S:0.11705},
58:{L:-0.2933,M:18.3906,S:0.11699},
59:{L:-0.2917,M:18.5918,S:0.11694},
60:{L:-0.2902,M:18.7928,S:0.11688}
};

/* ---------- TB/U LAKI-LAKI (0–60 bln) ---------- */
const LMS_TBU_L = {
0:{L:1.0,M:49.8842,S:0.03795},
1:{L:1.0,M:54.7244,S:0.03557},
2:{L:1.0,M:58.4249,S:0.03424},
3:{L:1.0,M:61.4292,S:0.03328},
4:{L:1.0,M:63.886,S:0.03257},
5:{L:1.0,M:65.9026,S:0.03204},
6:{L:1.0,M:67.6236,S:0.03165},
7:{L:1.0,M:69.1645,S:0.03139},
8:{L:1.0,M:70.5994,S:0.03119},
9:{L:1.0,M:71.9687,S:0.03103},
10:{L:1.0,M:73.2812,S:0.0309},
11:{L:1.0,M:74.5388,S:0.03078},
12:{L:1.0,M:75.7488,S:0.03067},
13:{L:1.0,M:76.9186,S:0.03057},
14:{L:1.0,M:78.0497,S:0.03047},
15:{L:1.0,M:79.1458,S:0.03038},
16:{L:1.0,M:80.2113,S:0.03029},
17:{L:1.0,M:81.2487,S:0.03021},
18:{L:1.0,M:82.2587,S:0.03013},
19:{L:1.0,M:83.2418,S:0.03005},
20:{L:1.0,M:84.1996,S:0.02998},
21:{L:1.0,M:85.1348,S:0.0299},
22:{L:1.0,M:86.0477,S:0.02983},
23:{L:1.0,M:86.941,S:0.02975},
24:{L:1.0,M:87.8161,S:0.02968},
25:{L:1.0,M:88.6731,S:0.02961},
26:{L:1.0,M:89.5129,S:0.02954},
27:{L:1.0,M:90.3364,S:0.02947},
28:{L:1.0,M:91.1441,S:0.0294},
29:{L:1.0,M:91.9366,S:0.02934},
30:{L:1.0,M:92.7142,S:0.02927},
31:{L:1.0,M:93.4773,S:0.02921},
32:{L:1.0,M:94.2264,S:0.02915},
33:{L:1.0,M:94.9616,S:0.02909},
34:{L:1.0,M:95.6835,S:0.02903},
35:{L:1.0,M:96.3923,S:0.02897},
36:{L:1.0,M:97.0884,S:0.02892},
37:{L:1.0,M:97.7721,S:0.02886},
38:{L:1.0,M:98.4437,S:0.02881},
39:{L:1.0,M:99.1034,S:0.02876},
40:{L:1.0,M:99.7514,S:0.02871},
41:{L:1.0,M:100.3879,S:0.02866},
42:{L:1.0,M:101.0132,S:0.02861},
43:{L:1.0,M:101.6275,S:0.02857},
44:{L:1.0,M:102.2311,S:0.02852},
45:{L:1.0,M:102.8242,S:0.02848},
46:{L:1.0,M:103.407,S:0.02844},
47:{L:1.0,M:103.9798,S:0.0284},
48:{L:1.0,M:104.5427,S:0.02836},
49:{L:1.0,M:105.0959,S:0.02832},
50:{L:1.0,M:105.6397,S:0.02828},
51:{L:1.0,M:106.1742,S:0.02825},
52:{L:1.0,M:106.6996,S:0.02821},
53:{L:1.0,M:107.2161,S:0.02818},
54:{L:1.0,M:107.7238,S:0.02814},
55:{L:1.0,M:108.223,S:0.02811},
56:{L:1.0,M:108.7137,S:0.02808},
57:{L:1.0,M:109.1962,S:0.02805},
58:{L:1.0,M:109.6705,S:0.02802},
59:{L:1.0,M:110.1368,S:0.02799},
60:{L:1.0,M:110.5951,S:0.02796}
};

/* ---------- TB/U PEREMPUAN (0–60 bln) ---------- */
const LMS_TBU_P = {
0:{L:1.0,M:49.1477,S:0.0379},
1:{L:1.0,M:53.6872,S:0.0364},
2:{L:1.0,M:57.0673,S:0.03568},
3:{L:1.0,M:59.8029,S:0.0352},
4:{L:1.0,M:62.0899,S:0.03486},
5:{L:1.0,M:64.0301,S:0.03465},
6:{L:1.0,M:65.7311,S:0.03453},
7:{L:1.0,M:67.2873,S:0.03448},
8:{L:1.0,M:68.7498,S:0.03448},
9:{L:1.0,M:70.1435,S:0.03451},
10:{L:1.0,M:71.4818,S:0.03457},
11:{L:1.0,M:72.771,S:0.03464},
12:{L:1.0,M:74.015,S:0.03472},
13:{L:1.0,M:75.2176,S:0.03479},
14:{L:1.0,M:76.3817,S:0.03486},
15:{L:1.0,M:77.5099,S:0.03493},
16:{L:1.0,M:78.6055,S:0.035},
17:{L:1.0,M:79.671,S:0.03506},
18:{L:1.0,M:80.7089,S:0.03512},
19:{L:1.0,M:81.721,S:0.03518},
20:{L:1.0,M:82.7089,S:0.03523},
21:{L:1.0,M:83.6736,S:0.03528},
22:{L:1.0,M:84.6163,S:0.03533},
23:{L:1.0,M:85.5384,S:0.03537},
24:{L:1.0,M:86.4412,S:0.03542},
25:{L:1.0,M:87.3254,S:0.03546},
26:{L:1.0,M:88.1916,S:0.0355},
27:{L:1.0,M:89.0402,S:0.03554},
28:{L:1.0,M:89.8716,S:0.03558},
29:{L:1.0,M:90.6862,S:0.03562},
30:{L:1.0,M:91.4842,S:0.03565},
31:{L:1.0,M:92.266,S:0.03569},
32:{L:1.0,M:93.0317,S:0.03572},
33:{L:1.0,M:93.7817,S:0.03575},
34:{L:1.0,M:94.5162,S:0.03578},
35:{L:1.0,M:95.2354,S:0.03581},
36:{L:1.0,M:95.9396,S:0.03583},
37:{L:1.0,M:96.629,S:0.03586},
38:{L:1.0,M:97.3038,S:0.03588},
39:{L:1.0,M:97.9642,S:0.0359},
40:{L:1.0,M:98.6103,S:0.03592},
41:{L:1.0,M:99.2424,S:0.03594},
42:{L:1.0,M:99.8606,S:0.03596},
43:{L:1.0,M:100.465,S:0.03597},
44:{L:1.0,M:101.0562,S:0.03599},
45:{L:1.0,M:101.6343,S:0.036},
46:{L:1.0,M:102.1994,S:0.03601},
47:{L:1.0,M:102.7518,S:0.03602},
48:{L:1.0,M:103.2916,S:0.03603},
49:{L:1.0,M:103.819,S:0.03604},
50:{L:1.0,M:104.3342,S:0.03605},
51:{L:1.0,M:104.8373,S:0.03606},
52:{L:1.0,M:105.3285,S:0.03607},
53:{L:1.0,M:105.8079,S:0.03607},
54:{L:1.0,M:106.2755,S:0.03608},
55:{L:1.0,M:106.7315,S:0.03609},
56:{L:1.0,M:107.176,S:0.03609},
57:{L:1.0,M:107.6092,S:0.0361},
58:{L:1.0,M:108.0311,S:0.0361},
59:{L:1.0,M:108.442,S:0.03611},
60:{L:1.0,M:108.842,S:0.03611}
};

/* ===========================================================
   BB/TB Laki-laki dan Perempuan
   WHO 2006 / Permenkes 2-2020
   Usia 0–60 bulan, panjang/tinggi 45–110 cm
   Interval 0.5 cm
   =========================================================== */

/* -------------- BB/TB LAKI-LAKI -------------- */
const LMS_BBTB_L = {
45:{L:-0.3521,M:2.441,S:0.09182},
45.5:{L:-0.3521,M:2.531,S:0.09182},
46:{L:-0.3521,M:2.623,S:0.09182},
46.5:{L:-0.3521,M:2.719,S:0.09182},
47:{L:-0.3521,M:2.816,S:0.09182},
47.5:{L:-0.3521,M:2.916,S:0.09182},
48:{L:-0.3521,M:3.017,S:0.09182},
48.5:{L:-0.3521,M:3.12,S:0.09182},
49:{L:-0.3521,M:3.224,S:0.09182},
49.5:{L:-0.3521,M:3.329,S:0.09182},
50:{L:-0.3521,M:3.435,S:0.09182},
50.5:{L:-0.3521,M:3.541,S:0.09182},
51:{L:-0.3521,M:3.648,S:0.09182},
51.5:{L:-0.3521,M:3.755,S:0.09182},
52:{L:-0.3521,M:3.861,S:0.09182},
52.5:{L:-0.3521,M:3.968,S:0.09182},
53:{L:-0.3521,M:4.076,S:0.09182},
53.5:{L:-0.3521,M:4.186,S:0.09182},
54:{L:-0.3521,M:4.298,S:0.09182},
54.5:{L:-0.3521,M:4.411,S:0.09182},
55:{L:-0.3521,M:4.526,S:0.09182},
55.5:{L:-0.3521,M:4.641,S:0.09182},
56:{L:-0.3521,M:4.757,S:0.09182},
56.5:{L:-0.3521,M:4.874,S:0.09182},
57:{L:-0.3521,M:4.991,S:0.09182},
57.5:{L:-0.3521,M:5.108,S:0.09182},
58:{L:-0.3521,M:5.226,S:0.09182},
58.5:{L:-0.3521,M:5.344,S:0.09182},
59:{L:-0.3521,M:5.462,S:0.09182},
59.5:{L:-0.3521,M:5.58,S:0.09182},
60:{L:-0.3521,M:5.699,S:0.09182},
60.5:{L:-0.3521,M:5.819,S:0.09182},
61:{L:-0.3521,M:5.94,S:0.09182},
61.5:{L:-0.3521,M:6.063,S:0.09182},
62:{L:-0.3521,M:6.187,S:0.09182},
62.5:{L:-0.3521,M:6.313,S:0.09182},
63:{L:-0.3521,M:6.441,S:0.09182},
63.5:{L:-0.3521,M:6.571,S:0.09182},
64:{L:-0.3521,M:6.703,S:0.09182},
64.5:{L:-0.3521,M:6.838,S:0.09182},
65:{L:-0.3521,M:6.975,S:0.09182},
65.5:{L:-0.3521,M:7.114,S:0.09182},
66:{L:-0.3521,M:7.256,S:0.09182},
66.5:{L:-0.3521,M:7.4,S:0.09182},
67:{L:-0.3521,M:7.547,S:0.09182},
67.5:{L:-0.3521,M:7.696,S:0.09182},
68:{L:-0.3521,M:7.848,S:0.09182},
68.5:{L:-0.3521,M:8.002,S:0.09182},
69:{L:-0.3521,M:8.159,S:0.09182},
69.5:{L:-0.3521,M:8.318,S:0.09182},
70:{L:-0.3521,M:8.48,S:0.09182},
70.5:{L:-0.3521,M:8.644,S:0.09182},
71:{L:-0.3521,M:8.81,S:0.09182},
71.5:{L:-0.3521,M:8.978,S:0.09182},
72:{L:-0.3521,M:9.149,S:0.09182},
72.5:{L:-0.3521,M:9.321,S:0.09182},
73:{L:-0.3521,M:9.495,S:0.09182},
73.5:{L:-0.3521,M:9.671,S:0.09182},
74:{L:-0.3521,M:9.848,S:0.09182},
74.5:{L:-0.3521,M:10.027,S:0.09182},
75:{L:-0.3521,M:10.208,S:0.09182},
75.5:{L:-0.3521,M:10.39,S:0.09182},
76:{L:-0.3521,M:10.574,S:0.09182},
76.5:{L:-0.3521,M:10.759,S:0.09182},
77:{L:-0.3521,M:10.946,S:0.09182},
77.5:{L:-0.3521,M:11.134,S:0.09182},
78:{L:-0.3521,M:11.323,S:0.09182},
78.5:{L:-0.3521,M:11.513,S:0.09182},
79:{L:-0.3521,M:11.705,S:0.09182},
79.5:{L:-0.3521,M:11.898,S:0.09182},
80:{L:-0.3521,M:12.092,S:0.09182},
80.5:{L:-0.3521,M:12.287,S:0.09182},
81:{L:-0.3521,M:12.482,S:0.09182},
81.5:{L:-0.3521,M:12.679,S:0.09182},
82:{L:-0.3521,M:12.875,S:0.09182},
82.5:{L:-0.3521,M:13.073,S:0.09182},
83:{L:-0.3521,M:13.27,S:0.09182},
83.5:{L:-0.3521,M:13.468,S:0.09182},
84:{L:-0.3521,M:13.666,S:0.09182},
84.5:{L:-0.3521,M:13.865,S:0.09182},
85:{L:-0.3521,M:14.065,S:0.09182},
85.5:{L:-0.3521,M:14.265,S:0.09182},
86:{L:-0.3521,M:14.465,S:0.09182},
86.5:{L:-0.3521,M:14.665,S:0.09182},
87:{L:-0.3521,M:14.865,S:0.09182},
87.5:{L:-0.3521,M:15.066,S:0.09182},
88:{L:-0.3521,M:15.267,S:0.09182},
88.5:{L:-0.3521,M:15.468,S:0.09182},
89:{L:-0.3521,M:15.669,S:0.09182},
89.5:{L:-0.3521,M:15.871,S:0.09182},
90:{L:-0.3521,M:16.073,S:0.09182},
90.5:{L:-0.3521,M:16.275,S:0.09182},
91:{L:-0.3521,M:16.477,S:0.09182},
91.5:{L:-0.3521,M:16.679,S:0.09182},
92:{L:-0.3521,M:16.88,S:0.09182},
92.5:{L:-0.3521,M:17.082,S:0.09182},
93:{L:-0.3521,M:17.284,S:0.09182},
93.5:{L:-0.3521,M:17.486,S:0.09182},
94:{L:-0.3521,M:17.688,S:0.09182},
94.5:{L:-0.3521,M:17.889,S:0.09182},
95:{L:-0.3521,M:18.091,S:0.09182},
95.5:{L:-0.3521,M:18.292,S:0.09182},
96:{L:-0.3521,M:18.494,S:0.09182},
96.5:{L:-0.3521,M:18.695,S:0.09182},
97:{L:-0.3521,M:18.897,S:0.09182},
97.5:{L:-0.3521,M:19.098,S:0.09182},
98:{L:-0.3521,M:19.299,S:0.09182},
98.5:{L:-0.3521,M:19.5,S:0.09182},
99:{L:-0.3521,M:19.701,S:0.09182},
99.5:{L:-0.3521,M:19.902,S:0.09182},
100:{L:-0.3521,M:20.103,S:0.09182},
100.5:{L:-0.3521,M:20.304,S:0.09182},
101:{L:-0.3521,M:20.505,S:0.09182},
101.5:{L:-0.3521,M:20.706,S:0.09182},
102:{L:-0.3521,M:20.907,S:0.09182},
102.5:{L:-0.3521,M:21.108,S:0.09182},
103:{L:-0.3521,M:21.309,S:0.09182},
103.5:{L:-0.3521,M:21.511,S:0.09182},
104:{L:-0.3521,M:21.713,S:0.09182},
104.5:{L:-0.3521,M:21.916,S:0.09182},
105:{L:-0.3521,M:22.119,S:0.09182},
105.5:{L:-0.3521,M:22.322,S:0.09182},
106:{L:-0.3521,M:22.525,S:0.09182},
106.5:{L:-0.3521,M:22.728,S:0.09182},
107:{L:-0.3521,M:22.931,S:0.09182},
107.5:{L:-0.3521,M:23.134,S:0.09182},
108:{L:-0.3521,M:23.337,S:0.09182},
108.5:{L:-0.3521,M:23.54,S:0.09182},
109:{L:-0.3521,M:23.743,S:0.09182},
109.5:{L:-0.3521,M:23.965,S:0.09182},
110:{L:-0.3521,M:24.188,S:0.09182}
};

/* -------------- BB/TB PEREMPUAN -------------- */
const LMS_BBTB_P = {
45:{L:-0.3833,M:2.395,S:0.09182},
45.5:{L:-0.3833,M:2.484,S:0.09182},
46:{L:-0.3833,M:2.576,S:0.09182},
46.5:{L:-0.3833,M:2.67,S:0.09182},
47:{L:-0.3833,M:2.766,S:0.09182},
47.5:{L:-0.3833,M:2.864,S:0.09182},
48:{L:-0.3833,M:2.964,S:0.09182},
48.5:{L:-0.3833,M:3.066,S:0.09182},
49:{L:-0.3833,M:3.169,S:0.09182},
49.5:{L:-0.3833,M:3.274,S:0.09182},
50:{L:-0.3833,M:3.379,S:0.09182},
50.5:{L:-0.3833,M:3.485,S:0.09182},
51:{L:-0.3833,M:3.591,S:0.09182},
51.5:{L:-0.3833,M:3.698,S:0.09182},
52:{L:-0.3833,M:3.806,S:0.09182},
52.5:{L:-0.3833,M:3.914,S:0.09182},
53:{L:-0.3833,M:4.023,S:0.09182},
53.5:{L:-0.3833,M:4.133,S:0.09182},
54:{L:-0.3833,M:4.243,S:0.09182},
54.5:{L:-0.3833,M:4.354,S:0.09182},
55:{L:-0.3833,M:4.466,S:0.09182},
55.5:{L:-0.3833,M:4.578,S:0.09182},
56:{L:-0.3833,M:4.691,S:0.09182},
56.5:{L:-0.3833,M:4.803,S:0.09182},
57:{L:-0.3833,M:4.916,S:0.09182},
57.5:{L:-0.3833,M:5.029,S:0.09182},
58:{L:-0.3833,M:5.142,S:0.09182},
58.5:{L:-0.3833,M:5.255,S:0.09182},
59:{L:-0.3833,M:5.368,S:0.09182},
59.5:{L:-0.3833,M:5.48,S:0.09182},
60:{L:-0.3833,M:5.592,S:0.09182},
60.5:{L:-0.3833,M:5.704,S:0.09182},
61:{L:-0.3833,M:5.815,S:0.09182},
61.5:{L:-0.3833,M:5.926,S:0.09182},
62:{L:-0.3833,M:6.036,S:0.09182},
62.5:{L:-0.3833,M:6.145,S:0.09182},
63:{L:-0.3833,M:6.254,S:0.09182},
63.5:{L:-0.3833,M:6.363,S:0.09182},
64:{L:-0.3833,M:6.472,S:0.09182},
64.5:{L:-0.3833,M:6.581,S:0.09182},
65:{L:-0.3833,M:6.69,S:0.09182},
65.5:{L:-0.3833,M:6.8,S:0.09182},
66:{L:-0.3833,M:6.911,S:0.09182},
66.5:{L:-0.3833,M:7.023,S:0.09182},
67:{L:-0.3833,M:7.137,S:0.09182},
67.5:{L:-0.3833,M:7.252,S:0.09182},
68:{L:-0.3833,M:7.369,S:0.09182},
68.5:{L:-0.3833,M:7.487,S:0.09182},
69:{L:-0.3833,M:7.607,S:0.09182},
69.5:{L:-0.3833,M:7.728,S:0.09182},
70:{L:-0.3833,M:7.851,S:0.09182},
70.5:{L:-0.3833,M:7.977,S:0.09182},
71:{L:-0.3833,M:8.104,S:0.09182},
71.5:{L:-0.3833,M:8.233,S:0.09182},
72:{L:-0.3833,M:8.363,S:0.09182},
72.5:{L:-0.3833,M:8.494,S:0.09182},
73:{L:-0.3833,M:8.626,S:0.09182},
73.5:{L:-0.3833,M:8.759,S:0.09182},
74:{L:-0.3833,M:8.893,S:0.09182},
74.5:{L:-0.3833,M:9.028,S:0.09182},
75:{L:-0.3833,M:9.164,S:0.09182},
75.5:{L:-0.3833,M:9.3,S:0.09182},
76:{L:-0.3833,M:9.437,S:0.09182},
76.5:{L:-0.3833,M:9.575,S:0.09182},
77:{L:-0.3833,M:9.713,S:0.09182},
77.5:{L:-0.3833,M:9.853,S:0.09182},
78:{L:-0.3833,M:9.992,S:0.09182},
78.5:{L:-0.3833,M:10.133,S:0.09182},
79:{L:-0.3833,M:10.274,S:0.09182},
79.5:{L:-0.3833,M:10.416,S:0.09182},
80:{L:-0.3833,M:10.558,S:0.09182},
80.5:{L:-0.3833,M:10.701,S:0.09182},
81:{L:-0.3833,M:10.844,S:0.09182},
81.5:{L:-0.3833,M:10.988,S:0.09182},
82:{L:-0.3833,M:11.132,S:0.09182},
82.5:{L:-0.3833,M:11.276,S:0.09182},
83:{L:-0.3833,M:11.42,S:0.09182},
83.5:{L:-0.3833,M:11.564,S:0.09182},
84:{L:-0.3833,M:11.708,S:0.09182},
84.5:{L:-0.3833,M:11.853,S:0.09182},
85:{L:-0.3833,M:11.997,S:0.09182},
85.5:{L:-0.3833,M:12.141,S:0.09182},
86:{L:-0.3833,M:12.285,S:0.09182},
86.5:{L:-0.3833,M:12.428,S:0.09182},
87:{L:-0.3833,M:12.572,S:0.09182},
87.5:{L:-0.3833,M:12.715,S:0.09182},
88:{L:-0.3833,M:12.857,S:0.09182},
88.5:{L:-0.3833,M:12.999,S:0.09182},
89:{L:-0.3833,M:13.14,S:0.09182},
89.5:{L:-0.3833,M:13.281,S:0.09182},
90:{L:-0.3833,M:13.421,S:0.09182},
90.5:{L:-0.3833,M:13.561,S:0.09182},
91:{L:-0.3833,M:13.7,S:0.09182},
91.5:{L:-0.3833,M:13.838,S:0.09182},
92:{L:-0.3833,M:13.976,S:0.09182},
92.5:{L:-0.3833,M:14.113,S:0.09182},
93:{L:-0.3833,M:14.249,S:0.09182},
93.5:{L:-0.3833,M:14.385,S:0.09182},
94:{L:-0.3833,M:14.52,S:0.09182},
94.5:{L:-0.3833,M:14.654,S:0.09182},
95:{L:-0.3833,M:14.787,S:0.09182},
95.5:{L:-0.3833,M:14.919,S:0.09182},
96:{L:-0.3833,M:15.05,S:0.09182},
96.5:{L:-0.3833,M:15.181,S:0.09182},
97:{L:-0.3833,M:15.31,S:0.09182},
97.5:{L:-0.3833,M:15.439,S:0.09182},
98:{L:-0.3833,M:15.567,S:0.09182},
98.5:{L:-0.3833,M:15.694,S:0.09182},
99:{L:-0.3833,M:15.82,S:0.09182},
99.5:{L:-0.3833,M:15.946,S:0.09182},
100:{L:-0.3833,M:16.071,S:0.09182},
100.5:{L:-0.3833,M:16.195,S:0.09182},
101:{L:-0.3833,M:16.318,S:0.09182},
101.5:{L:-0.3833,M:16.441,S:0.09182},
102:{L:-0.3833,M:16.563,S:0.09182},
102.5:{L:-0.3833,M:16.684,S:0.09182},
103:{L:-0.3833,M:16.805,S:0.09182},
103.5:{L:-0.3833,M:16.925,S:0.09182},
104:{L:-0.3833,M:17.044,S:0.09182},
104.5:{L:-0.3833,M:17.163,S:0.09182},
105:{L:-0.3833,M:17.282,S:0.09182},
105.5:{L:-0.3833,M:17.4,S:0.09182},
106:{L:-0.3833,M:17.518,S:0.09182},
106.5:{L:-0.3833,M:17.635,S:0.09182},
107:{L:-0.3833,M:17.752,S:0.09182},
107.5:{L:-0.3833,M:17.868,S:0.09182},
108:{L:-0.3833,M:17.985,S:0.09182},
108.5:{L:-0.3833,M:18.101,S:0.09182},
109:{L:-0.3833,M:18.217,S:0.09182},
109.5:{L:-0.3833,M:18.332,S:0.09182},
110:{L:-0.3833,M:18.448,S:0.09182}
};

let c1,c2,c3;

function hitung(){

 let usia=parseInt(document.getElementById("usia").value);
 let bb=parseFloat(document.getElementById("bb").value);
 let tb=parseFloat(document.getElementById("tb").value);

 if(!gender){document.getElementById("err").innerHTML="Pilih jenis kelamin dulu";return;}
 if(isNaN(usia)|| usia<0 || usia>60){document.getElementById("err").innerHTML="Usia harus 0–60 bulan";return;}
 if(isNaN(bb)||bb<=0){document.getElementById("err").innerHTML="Berat badan tidak valid";return;}
 if(isNaN(tb)||tb<45||tb>120){document.getElementById("err").innerHTML="Tinggi badan harus 45–120 cm";return;}

 document.getElementById("err").innerHTML="";

 let BBU = (gender==="L"?LMS_BBU_L:LMS_BBU_P)[usia];
 let TBU = (gender==="L"?LMS_TBU_L:LMS_TBU_P)[usia];

 let keyTB = Math.round(tb*2)/2;
 let BBTB = (gender==="L"?LMS_BBTB_L:LMS_BBTB_P)[keyTB];

 let zbbu=zscore(bb,BBU.L,BBU.M,BBU.S);
 let ztbu=zscore(tb,TBU.L,TBU.M,TBU.S);
 let zbbtb=zscore(bb,BBTB.L,BBTB.M,BBTB.S);

 document.getElementById("hasil").innerHTML=
 `<div class='result-box'>
 <b>Hasil Status Gizi</b><br>
 BB/U : ${zbbu.toFixed(2)} → <b>${kategoriBBU(zbbu)}</b><br>
 TB/U : ${ztbu.toFixed(2)} → <b>${kategoriTBU(ztbu)}</b><br>
 BB/TB : ${zbbtb.toFixed(2)} → <b>${kategoriBBTB(zbbtb)}</b><br><br>
 <b>Saran Gizi:</b><br>${saran(zbbu,ztbu,zbbtb)}
 </div>`;

 if(c1)c1.destroy();if(c2)c2.destroy();if(c3)c3.destroy();

 c1=new Chart(document.getElementById("chartBBU"),{type:'line',
 data:{labels:['-3','-2','-1','0','+1','+2','+3','Anak'],
 datasets:[{data:[-3,-2,-1,0,1,2,3,zbbu],fill:false}]}});

 c2=new Chart(document.getElementById("chartTBU"),{type:'line',
 data:{labels:['-3','-2','-1','0','+1','+2','+3','Anak'],
 datasets:[{data:[-3,-2,-1,0,1,2,3,ztbu],fill:false}]}});

 c3=new Chart(document.getElementById("chartBBTB"),{type:'line',
 data:{labels:['-3','-2','-1','0','+1','+2','+3','Anak'],
 datasets:[{data:[-3,-2,-1,0,1,2,3,zbbtb],fill:false}]}});

}

async function downloadPDF(){
 const {jsPDF}=window.jspdf;
 const el=document.getElementById("exportArea");
 const canvas=await html2canvas(el);
 const img=canvas.toDataURL("image/png");
 const pdf=new jsPDF("p","mm","a4");
 const w=190;
 const h=canvas.height*190/canvas.width;
 pdf.addImage(img,"PNG",10,10,w,h);
 pdf.save("status-gizi.pdf");
}
</script>

<script>
if("serviceWorker" in navigator){
 navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>
